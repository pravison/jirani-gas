{% extends 'business/main.html' %}
{% load static %}
{% load humanize%}
{% block title %} Edit {% endblock%}
{% block content %}

<main id="main" class="main">
    {% if messages %}
        {% for message in messages %}
          <div class="alert alert-warning alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
    
    
        {% endfor %}
    {% endif %}
    
        <div class="pagetitle">
          <h1>Add Loyalty Points</h1>
          <nav>
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="{% url 'dashboard' business.slug %}">Dashboard</a></li>
              <li class="breadcrumb-item"><a href="{% url 'loyalty_points_category' business.slug %}">Loyalty Categories</a></li>
            </ol>
          </nav>
        </div><!-- End Page Title -->
    
        <section class="section">
          <div class="row">
            <div class="col-lg-12">
    
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title">Add</h5>
    
                  {% if form.errors or form.non_field_errors %}
                      <div class="mb-3 p-6 bg-red-100 rounded-xl">
                          {% for field in form %}
                              {{ field.errors }}
                          {% endfor %}
    
                          {{ form.non_field_errors }}
                      </div>
                  {% endif %}
    
                  <!-- General Form Elements -->
                  <form method="POST", action="{% url 'add_product'  business.slug %}">
                    {% csrf_token %}
                    {% if form.errors %}
                      <div class="alert alert-warning alert-dismissible fade show" role="alert">
                        Your Form Has Errors
                        {% for field in form %}
                          {% if field.errors %}
                            {{ field.errors }}
                          {% endif %}
                        {% endfor %}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                      </div>
                    {% endif %}
    
                    <div class="row mb-3">
                        <div class="col-sm-10 justify-content-center">
                            <select class="form-control" name="category" placeholder="Select Coupone Type" required>
                                <option value="">Select Product Category</option>
                                <option value="6kg gas">6kg gas</option>
                                {% for category in product_categories %}
                                <option value="{{category.category_name}}">{{category.category_name}}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-sm-10 justify-content-center">
                            <select class="form-control" name="product_name" placeholder="Select Coupone Type" required>
                                <option value="">Select Product Name</option>
                                <option value="Total gas">Total gas</option>
                                {% for name in product_names %}
                                <option value="{{name.name}}">{{name.name}}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-sm-10 justify-content-center">
                          <input class="form-control" name="price" type="number" value="" placeholder="enter product price" required/>
                        </div>
                    </div>
                
                    <div class="row mb-3">
                      <div class="col-sm-10 justify-content-center">
                        <button type="submit" class="btn btn-primary " id="RegisteringAccount">Save</button>
                      </div>
                    </div>
    
                  </form><!-- End General Form Elements -->
    
                </div>
              </div>
    
            </div>
          </div>
        </section>
    
      </main><!-- End #main -->
    
      <script>
        src="https://code.jquery.com/jquery-3.6.0.min.js"
      </script>
      <script>
        $(document).ready(function(){
          $('.autocomplete').autocomplete(
            {
              source:'/customer-autocomplete/',
            }
          );
        });
      </script>
      <script>
        // Add an event listener to the form submission
        document.addEventListener('DOMContentLoaded', function () {
            const loginButton = document.getElementById('RegisteringAccount');
            const form = loginButton.closest('form'); // Find the closest form element
    
            if (form) {
                form.addEventListener('submit', function () {
                    // Disable the button
                    loginButton.disabled = true;
    
                    // Update the button text
                    loginButton.textContent = "adding points to customer...";
                });
            }
        });
      </script>
{% endblock %}